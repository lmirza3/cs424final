<!DOCTYPE html>
<html lang="en">
	<head>
        <meta charset="utf-8">
		<title>D3 Test</title>
		<script src="https://d3js.org/d3.v4.js"></script>
	</head>
	<body>
        <script type="text/javascript">

        	d3.csv("cs424data-avg.csv", function(dataAvg) {
				d3.csv("cs424data.csv", function(dataSet) {

					//debug check dsv parse
					//console.log(dataSet);
					//console.log(dataAvg);

					//canvas
					var width = 650,
						height = 600,
						cw = width/2,
						ch = height/2;

					//frequency sets
					var freq700 = [],
						freq850 = [],
						freq1700 = [],
						freq1900 = [];

					dataSet.forEach(function(d){
						freq700.push(parseFloat(d.f700));
						freq850.push(parseFloat(d.f850));
						freq1700.push(parseFloat(d.f1700));
						freq1900.push(parseFloat(d.f1900));
					});
					//popping the end element, because object column gets parsed in
					freq700.pop();
					freq850.pop();
					freq1700.pop();
					freq1900.pop();

					//debug check freq array
					//console.log(freq700);
					//console.log(freq850);

					//edge decibels
					var tmpArr = freq700.concat(freq850, freq1700, freq1900);
					var maxDB = Math.max.apply(Math, tmpArr),
						minDB = Math.min.apply(Math, tmpArr);

					//debug check tmp and min/max
					// console.log(tmpArr);
					// console.log(maxDB);
					// console.log(minDB);

					var pi = Math.PI;

					var x = 41.87113567;
					var y = -87.647697227902;

					var i = 0;
					var info;
					while(i < dataAvg.length){
						//console.log(dataAvg[i]);
						if(parseFloat(dataAvg[i].latitude) == x && parseFloat(dataAvg[i].longitude) == y){
							info = dataAvg[i];
							break;
						}
						i++;
					}
					console.log(info);

					//sunburst scale
		            var sunArcScale = d3.scaleLinear()
		            	.domain([0,60])
		            	.range([minDB, maxDB])

					//set svg canvas
            		var canvas = d3.select("body").append("svg")
		            	.attr("width", width)
		            	.attr("height", height)

		            var group = canvas.append("g")
          				.attr("transform", "translate("+ cw +","+ ch +")");

          			var arc = d3.arc()
				           .innerRadius(10)

				           console.log(info.f700avg);

          			//for (i=0; i < 4; i++){
			            
						var drawArc = group.append("path")
							.datum({outerRadius: sunArcScale(info.f700avg)})
							.datum({startAngle: 0* 90 * (pi/180)})
							.datum({endAngle: (0+1) * 90 * (pi/180)})
							.style("fill", "blue")
							.attr("d", arc);
						
					//}

				});
			});

        </script>
	</body>
</html>